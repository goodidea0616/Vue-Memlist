{"version":3,"sources":["webpack:///./src/view/pages/ml/ImportCompanies.vue?a59f","webpack:///./src/view/pages/ml/ImportCompanies.vue?e4b3","webpack:///src/view/pages/ml/ImportCompanies.vue","webpack:///./src/view/pages/ml/ImportCompanies.vue?9ab5","webpack:///./src/view/pages/ml/ImportCompanies.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","on","showCountryGuide","staticStyle","_l","item","i","key","_s","iso","sv","_e","ref","$event","handleFileUpload","selectFile","column_def","id","refInFor","currentCompanyId","dbColumnOptions","coldefSelected","toastr","file_id","mapped_columns","startImport","importFailed","importFinalized","finalizeReady","setImportId","import_id","import_option","doFinalize","lastPage","nextPage","staticRenderFns","name","components","ImportColDefRow","ImportConfirmPage","ImportFinalizePage","computed","mounted","setPeriodName","that","showNext","wizard","startStep","clickableSteps","setTimeout","currentPage","currentStep","console","log","loadData","data","displayCountryGuide","countries","file_error","type_def","table_name","table_pk_name","columns","requirements","personnr","ssn","phone","email","address","fullname","emailorphone","sex","age","periodName","poll","watch","newValue","currentPeriodId","methods","loadCountries","file","$refs","files","uploadFile","click","formData","append","periods","length","e","preventDefault","goNext","getStep","submit","readColumnDefFromFile","setMappingRedRows","dups","mc1","duplicate","db","col_name","j","mc2","refreshMappingKeys","getLangText","lang_text","lang","text","setDbColDefOptions","push","value","lang_record","randomstr","importColDefRows","updateComponent","result","characters","charAt","Math","floor","random","charactersLength","btnContinue","$bvToast","toast","message","title","autoHideDelay","autohide","appendToast","variant","type","component"],"mappings":"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","file":"js/chunk-1ac3a365.bf7f05d8.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImportCompanies.vue?vue&type=style&index=0&id=22593549&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"px-5\",attrs:{\"id\":\"page-periods\"}},[_c('h5',{staticClass:\"mb-6 ml-2\"},[_vm._v(\"Import av medlemmar\")]),_c('b-card',{staticClass:\"mb-2\",attrs:{\"title\":\"\",\"hide-footer\":\"\"}},[_c('div',{staticClass:\"wizard wizard-3\",attrs:{\"id\":\"kt_wizard_v3\",\"data-wizard-state\":\"step-first\",\"data-wizard-clickable\":\"false\"}},[_c('div',{staticClass:\"wizard-nav border-bottom mb-1 mb-lg-5\"},[_c('div',{staticClass:\"wizard-steps px-8 py-8 px-lg-15 py-lg-3\"},[_c('div',{staticClass:\"wizard-step\",attrs:{\"data-wizard-type\":\"step\",\"data-wizard-state\":\"current\"}},[_c('div',{staticClass:\"wizard-label\"},[_c('h3',{staticClass:\"wizard-title\"},[_c('span',[_vm._v(\"1\")]),_vm._v(\" Ladda upp fil\")]),_c('div',{staticClass:\"wizard-bar\"})])]),_c('div',{staticClass:\"wizard-step\",attrs:{\"data-wizard-type\":\"step\"}},[_c('div',{staticClass:\"wizard-label\"},[_c('h3',{staticClass:\"wizard-title\"},[_c('span',[_vm._v(\"2\")]),_vm._v(\" Mappa Databas\")]),_c('div',{staticClass:\"wizard-bar\"})])]),_c('div',{staticClass:\"wizard-step\",attrs:{\"data-wizard-type\":\"step\"}},[_c('div',{staticClass:\"wizard-label\"},[_c('h3',{staticClass:\"wizard-title\"},[_c('span',[_vm._v(\"3\")]),_vm._v(\" Kontrollera\")]),_c('div',{staticClass:\"wizard-bar\"})])]),_c('div',{staticClass:\"wizard-step\",attrs:{\"data-wizard-type\":\"step\"}},[_c('div',{staticClass:\"wizard-label\"},[_c('h3',{staticClass:\"wizard-title\"},[_c('span',[_vm._v(\"4\")]),_vm._v(\" Import\")]),_c('div',{staticClass:\"wizard-bar\"})])])])]),_c('div',{staticClass:\"row justify-content-center py-12 px-8 py-lg-15 px-lg-10\"},[_c('div',{staticClass:\"col-xl-12 col-xxl-7\"},[_c('form',{staticClass:\"form\",attrs:{\"id\":\"kt_form\"}},[_c('div',{staticClass:\"pb-5\",attrs:{\"data-wizard-type\":\"step-content\",\"data-wizard-state\":\"current\"}},[_c('h4',{staticClass:\"mb-10 font-weight-bold text-dark\"},[_vm._v(\"Excel fil över föreningar\")]),_c('div',{staticClass:\"mb-8\"},[_c('p',[_vm._v(\"Hur hanteras landskoder i importen?\")]),_c('b-button',{attrs:{\"type\":\"button\",\"variant\":\"primary\"},on:{\"click\":_vm.showCountryGuide}},[_vm._v(\"Visa landguiden\")])],1),(_vm.displayCountryGuide)?_c('b-card',[_c('b-alert',{attrs:{\"show\":\"\",\"variant\":\"secondary\"}},[_vm._v(\"En kolumn som mappas som \\\"Land\\\" måste följa kodstandarden för landskoder enligt tabellen nedan. Fält där landskod saknas kommer att automatiskt mappa till Sverige.\")]),_c('div',{staticClass:\"table-responsive\"},[_c('table',{staticClass:\"table table-head-custom table-vertical-center table-head-bg table-borderless\"},[_c('tbody',[_c('tr',{staticStyle:{\"background-color\":\"black\",\"color\":\"white\"}},[_c('td',[_vm._v(\"Kod\")]),_c('td',[_vm._v(\"Land\")])]),_vm._l((_vm.countries),function(item,i){return [_c('tr',{key:i},[_c('td',[_vm._v(_vm._s(item.iso))]),_c('td',[_vm._v(_vm._s(item.sv))])])]})],2)])])],1):_vm._e(),_c('div',[_c('b-alert',{attrs:{\"show\":\"\",\"variant\":\"secondary\"}},[_vm._v(\"Ladda upp ett register över föreningar i \"),_c('strong',[_vm._v(\"XLSX\")]),_vm._v(\" format. Ifall filen är CSV eller XLS (Excel 97) format så måste filen sparas som XLSX format från Excel.\")]),_c('input',{ref:\"file\",attrs:{\"hidden\":\"\",\"type\":\"file\",\"id\":\"file\",\"accept\":\".xlsx\"},on:{\"change\":function($event){return _vm.handleFileUpload()}}}),_c('b-button',{attrs:{\"type\":\"button\",\"variant\":\"success\"},on:{\"click\":function($event){return _vm.selectFile()}}},[_vm._v(\"Ladda upp föreningsregister\")])],1),(_vm.file_error)?_c('div',{staticClass:\"mt-4\"},[_c('b-alert',{attrs:{\"show\":\"\",\"variant\":\"danger\"}},[_vm._v(\"Filen är ogiltig, kontrollera att filen är i XLSX format\")])],1):_vm._e()],1),_c('div',{staticClass:\"pb-5\",attrs:{\"data-wizard-type\":\"step-content\",\"data-wizard-state\":\"pending\"}},[_c('h4',{staticClass:\"mb-10 font-weight-bold text-dark\"},[_vm._v(\"Kontrollera importfälten\")]),_c('div',{staticClass:\"list-selects\"},[_c('div',{staticClass:\"table-responsive\"},[_c('table',{staticClass:\"table table-head-custom table-vertical-center table-head-bg table-borderless\"},[_c('thead',[_c('tr',{staticClass:\"text-left\"},[_c('th',{staticStyle:{\"min-width\":\"40px\"}},[_c('span',{staticClass:\"text-dark-75\"},[_vm._v(\"Kolumn\")])]),_c('th',[_vm._v(\"Excel fält\")]),_c('th',[_vm._v(\"Memlist fält\")])])]),_c('tbody',{ref:\"colDefRows\"},_vm._l((_vm.column_def.mapped_columns),function(item){return _c('ImportColDefRow',{key:item.id,ref:\"importColDefRows\",refInFor:true,attrs:{\"mappedColumn\":item,\"currentCompanyId\":_vm.currentCompanyId,\"dbColumnOptions\":_vm.dbColumnOptions},on:{\"coldefSelected\":_vm.coldefSelected,\"toastr\":_vm.toastr}})}),1)])])])]),_c('div',{staticClass:\"pb-5\",attrs:{\"data-wizard-type\":\"step-content\",\"data-wizard-state\":\"pending\"}},[_c('ImportConfirmPage',{ref:\"importConfirmPage\",attrs:{\"datatype\":\"companies\",\"file_id\":_vm.file_id,\"mapped_columns\":_vm.column_def.mapped_columns,\"startImport\":_vm.startImport,\"importFailed\":_vm.importFailed,\"importFinalized\":_vm.importFinalized},on:{\"finalizeReady\":_vm.finalizeReady,\"setImportId\":_vm.setImportId}})],1),_c('div',{staticClass:\"pb-5\",attrs:{\"data-wizard-type\":\"step-content\",\"data-wizard-state\":\"pending\"}},[_c('h4',{staticClass:\"mb-10 font-weight-bold text-dark\"},[_vm._v(\"Importerar\")]),_c('ImportFinalizePage',{attrs:{\"import_id\":_vm.import_id,\"import_option\":_vm.import_option,\"doFinalize\":_vm.doFinalize}})],1),_c('div',{staticClass:\"d-flex justify-content-between border-top pt-10\"},[_c('div',{staticClass:\"mr-2\"},[(!_vm.lastPage)?_c('button',{staticClass:\"btn btn-light-primary font-weight-bold text-uppercase px-9 py-4\",attrs:{\"data-wizard-type\":\"action-prev\"}},[_vm._v(\" Föregående \")]):_vm._e()]),_c('div',[(_vm.showNext)?_c('button',{ref:\"btnContinue\",staticClass:\"btn btn-primary font-weight-bold text-uppercase px-9 py-4\",attrs:{\"data-wizard-type\":\"action-next\"},on:{\"click\":_vm.nextPage}},[_vm._v(\" Nästa steg \")]):_vm._e()])])])])])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"px-5\" id=\"page-periods\">\r\n    <h5 class=\"mb-6 ml-2\">Import av medlemmar</h5>\r\n    <b-card title=\"\" class=\"mb-2\" hide-footer>\r\n      <!--begin: Wizard-->\r\n      <div\r\n        class=\"wizard wizard-3\"\r\n        id=\"kt_wizard_v3\"\r\n        data-wizard-state=\"step-first\"\r\n        data-wizard-clickable=\"false\"\r\n      >\r\n        <!--begin: Wizard Nav -->\r\n        <div class=\"wizard-nav border-bottom mb-1 mb-lg-5\">\r\n          <div class=\"wizard-steps px-8 py-8 px-lg-15 py-lg-3\">\r\n            <div class=\"wizard-step\" data-wizard-type=\"step\" data-wizard-state=\"current\">\r\n              <div class=\"wizard-label\">\r\n                <h3 class=\"wizard-title\"><span>1</span> Ladda upp fil</h3>\r\n                <div class=\"wizard-bar\"></div>\r\n              </div>\r\n            </div>\r\n            <div class=\"wizard-step\" data-wizard-type=\"step\">\r\n              <div class=\"wizard-label\">\r\n                <h3 class=\"wizard-title\"><span>2</span> Mappa Databas</h3>\r\n                <div class=\"wizard-bar\"></div>\r\n              </div>\r\n            </div>\r\n            <div class=\"wizard-step\" data-wizard-type=\"step\">\r\n              <div class=\"wizard-label\">\r\n                <h3 class=\"wizard-title\"><span>3</span> Kontrollera</h3>\r\n                <div class=\"wizard-bar\"></div>\r\n              </div>\r\n            </div>\r\n            <div class=\"wizard-step\" data-wizard-type=\"step\">\r\n              <div class=\"wizard-label\">\r\n                <h3 class=\"wizard-title\"><span>4</span> Import</h3>\r\n                <div class=\"wizard-bar\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <!--end: Wizard Nav -->\r\n\r\n        <!--begin: Wizard Body-->\r\n        <div class=\"row justify-content-center py-12 px-8 py-lg-15 px-lg-10\">\r\n          <div class=\"col-xl-12 col-xxl-7\">\r\n            <!--begin: Wizard Form-->\r\n            <form class=\"form\" id=\"kt_form\">\r\n              <!--begin: Wizard Step 1-->\r\n              <div class=\"pb-5\" data-wizard-type=\"step-content\" data-wizard-state=\"current\">\r\n                <h4 class=\"mb-10 font-weight-bold text-dark\">Excel fil över föreningar</h4>\r\n\r\n                <div class=\"mb-8\">\r\n                  <p>Hur hanteras landskoder i importen?</p>\r\n                  <b-button type=\"button\" variant=\"primary\" @click=\"showCountryGuide\">Visa landguiden</b-button>\r\n                </div>\r\n                <b-card v-if=\"displayCountryGuide\">\r\n                  <b-alert show variant=\"secondary\"\r\n                    >En kolumn som mappas som \"Land\" måste följa kodstandarden för landskoder enligt tabellen nedan. Fält där landskod saknas kommer att automatiskt mappa till Sverige.</b-alert\r\n                  >\r\n\r\n                  <div class=\"table-responsive\">\r\n                    <table\r\n                      class=\"table table-head-custom table-vertical-center table-head-bg table-borderless\"\r\n                    >\r\n                      <tbody>\r\n                        <tr style=\"background-color: black; color: white;\">\r\n                            <td>Kod</td>\r\n                            <td>Land</td>\r\n                        </tr>\r\n                        <template v-for=\"(item, i) in countries\">\r\n                          <tr v-bind:key=\"i\">\r\n                            <td>{{ item.iso }}</td>\r\n                            <td>{{ item.sv }}</td>\r\n                          </tr>\r\n                        </template>\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                </b-card>\r\n                <div>\r\n                  <b-alert show variant=\"secondary\"\r\n                    >Ladda upp ett register över föreningar i <strong>XLSX</strong> format. Ifall filen är\r\n                    CSV eller XLS (Excel 97) format så måste filen sparas som XLSX format från\r\n                    Excel.</b-alert\r\n                  >\r\n\r\n                  <input hidden type=\"file\" id=\"file\" ref=\"file\" v-on:change=\"handleFileUpload()\" accept=\".xlsx\" />\r\n\r\n                  <b-button type=\"button\" variant=\"success\" @click=\"selectFile()\"\r\n                    >Ladda upp föreningsregister</b-button\r\n                  >\r\n                </div>\r\n                <div v-if=\"file_error\" class=\"mt-4\">\r\n                  <b-alert show variant=\"danger\"\r\n                    >Filen är ogiltig, kontrollera att filen är i XLSX format</b-alert\r\n                  >\r\n                </div>\r\n              </div>\r\n              <!--end: Wizard Step 1-->\r\n\r\n              <!--begin: Wizard step 2-->\r\n              <div class=\"pb-5\" data-wizard-type=\"step-content\" data-wizard-state=\"pending\">\r\n                <h4 class=\"mb-10 font-weight-bold text-dark\">Kontrollera importfälten</h4>\r\n\r\n                <div class=\"list-selects\">\r\n                  <div class=\"table-responsive\">\r\n                    <table\r\n                      class=\"table table-head-custom table-vertical-center table-head-bg table-borderless\"\r\n                    >\r\n                      <thead>\r\n                        <tr class=\"text-left\">\r\n                          <th style=\"min-width: 40px\">\r\n                            <span class=\"text-dark-75\">Kolumn</span>\r\n                          </th>\r\n                          <th>Excel fält</th>\r\n                          <th>Memlist fält</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody ref=\"colDefRows\">\r\n                        <ImportColDefRow\r\n                          v-for=\"item in column_def.mapped_columns\"\r\n                          ref=\"importColDefRows\"\r\n                          :key=\"item.id\"\r\n                          :mappedColumn=\"item\"\r\n                          :currentCompanyId=\"currentCompanyId\"\r\n                          :dbColumnOptions=\"dbColumnOptions\"\r\n                          @coldefSelected=\"coldefSelected\"\r\n                          @toastr=\"toastr\"\r\n                        />\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <!--end: wizard step 2-->\r\n\r\n              <!--begin: wizard step 4-->\r\n              <div class=\"pb-5\" data-wizard-type=\"step-content\" data-wizard-state=\"pending\">\r\n                \r\n                <ImportConfirmPage\r\n                  ref=\"importConfirmPage\"\r\n                  datatype=\"companies\"\r\n                  :file_id=\"file_id\"\r\n                  :mapped_columns=\"column_def.mapped_columns\"\r\n                  :startImport=\"startImport\"\r\n                  :importFailed=\"importFailed\"\r\n                  :importFinalized=\"importFinalized\"\r\n                  @finalizeReady=\"finalizeReady\"\r\n                  @setImportId=\"setImportId\"\r\n                 />\r\n              </div>\r\n              <!--end: wizard step 4-->\r\n\r\n              <!--begin: wizard step 5-->\r\n              <div class=\"pb-5\" data-wizard-type=\"step-content\" data-wizard-state=\"pending\">\r\n                <h4 class=\"mb-10 font-weight-bold text-dark\">Importerar</h4>\r\n\r\n                <ImportFinalizePage\r\n                  :import_id=\"import_id\"\r\n                  :import_option=\"import_option\"\r\n                  :doFinalize=\"doFinalize\"\r\n                />\r\n              </div>\r\n              <!--end: wizard step 5-->\r\n\r\n              <!--begin: Wizard Actions -->\r\n              <div class=\"d-flex justify-content-between border-top pt-10\">\r\n                <div class=\"mr-2\">\r\n                  <button\r\n                    class=\"btn btn-light-primary font-weight-bold text-uppercase px-9 py-4\"\r\n                    data-wizard-type=\"action-prev\"\r\n                    v-if=\"!lastPage\"\r\n                  >\r\n                    Föregående\r\n                  </button>\r\n                </div>\r\n                <div>\r\n                  <button\r\n                    class=\"btn btn-primary font-weight-bold text-uppercase px-9 py-4\"\r\n                    data-wizard-type=\"action-next\"\r\n                    v-on:click=\"nextPage\"\r\n                    ref=\"btnContinue\"\r\n                    v-if=\"showNext\"\r\n                  >\r\n                    Nästa steg\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <!--end: Wizard Actions -->\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </b-card>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/assets/sass/pages/wizard/wizard-3.scss';\r\n\r\n.checkbox.checkbox-light-success > span {\r\n  background-color: white;\r\n  border: 1px solid #ddd;\r\n}\r\n</style>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport { mapGetters } from 'vuex';\r\nimport ImportColDefRow from '@/view/pages/ml/import/ImportColDefRow.vue';\r\nimport ImportConfirmPage from '@/view/pages/ml/import/ImportConfirmPage.vue';\r\nimport ImportFinalizePage from '@/view/pages/ml/import/ImportFinalizePage.vue';\r\n\r\nimport KTUtil from '@/assets/js/components/util';\r\nimport KTWizard from '@/assets/js/components/wizard';\r\n\r\nexport default {\r\n  name: 'import',\r\n  components: {\r\n    ImportColDefRow,\r\n    ImportConfirmPage,\r\n    ImportFinalizePage\r\n  },\r\n  computed: {\r\n    ...mapGetters(['currentCompanyId', 'currentPeriodId', 'periods'])\r\n  },\r\n  mounted() {\r\n    this.setPeriodName();\r\n\r\n    var that = this;\r\n    this.showNext = true;\r\n\r\n    // Initialize form wizard\r\n    this.wizard = new KTWizard('kt_wizard_v3', {\r\n      startStep: 1, // initial active step number\r\n      clickableSteps: true // allow step clicking\r\n    });\r\n\r\n    // Validation before going to next page\r\n    this.wizard.on('beforeNext', function (/*wizardObj*/) {\r\n      // validate the form and use below function to stop the wizard's step\r\n      // wizardObj.stop();\r\n    });\r\n\r\n    // Change event\r\n    this.wizard.on('change', function (/*wizardObj*/) {\r\n      setTimeout(() => {\r\n        KTUtil.scrollTop();\r\n\r\n        that.currentPage = that.wizard.currentStep;\r\n\r\n        console.log('page change: ');\r\n        console.log(that.currentPage);\r\n\r\n        if (that.currentPage === 2 || that.currentPage === 3) {\r\n          that.showNext = true;\r\n        }\r\n      }, 200);\r\n    });\r\n\r\n    this.loadData();\r\n\r\n    this.showNext = false;\r\n  },\r\n  data() {\r\n    return {\r\n      lastPage: false,\r\n      displayCountryGuide: false,\r\n      countries: [],\r\n      showNext: true,\r\n      currentPage: 0,\r\n      file_error: false,\r\n      dbColumnOptions: [],\r\n      wizard: null,\r\n      import_option: null,\r\n      column_def: {\r\n        import_id: '',\r\n        file_id: '31',\r\n        mapped_columns: [\r\n          {\r\n            id: 'aa',\r\n            db: {\r\n              col_name: 'rdt',\r\n              lang_text: 'registrering',\r\n              attr: false\r\n            },\r\n            excel: {\r\n              col: 0,\r\n              name: 'Registreringsdatum'\r\n            },\r\n            values: ['2018-01-19 01:30:00']\r\n          },\r\n          {\r\n            id: 'bb',\r\n            db: {\r\n              col_name: 'firstname',\r\n              lang_text: 'Förnamn',\r\n              attr: false\r\n            },\r\n            excel: {\r\n              col: 1,\r\n              name: 'Förnamn'\r\n            },\r\n            values: ['Jakob']\r\n          }\r\n        ]\r\n      },\r\n      type_def: {\r\n        table_name: 'ml_company',\r\n        table_pk_name: 'company_id',\r\n        columns: [\r\n          {\r\n            col_name: 'skip',\r\n            variation_lang_records: [],\r\n            valtype: '',\r\n            special: false,\r\n            func: '',\r\n            max_length: 0,\r\n            variations: [],\r\n            entity: 'company',\r\n            lang_record: {\r\n              deleted: 0,\r\n              lang_record_id: 'CLIENT_SKIP',\r\n              page_name: 'ml_header.html',\r\n              lang_text: [\r\n                {\r\n                  lang: 'sv',\r\n                  text: 'Hoppa över'\r\n                },\r\n                {\r\n                  lang: 'en',\r\n                  text: ''\r\n                }\r\n              ]\r\n            },\r\n            exclude: []\r\n          },\r\n          {\r\n            col_name: 'public_id',\r\n            variation_lang_records: [\r\n              {\r\n                deleted: 0,\r\n                lang_record_id: 'CLIENT_MEDLEMSNUMMER',\r\n                page_name: 'all',\r\n                lang_text: [\r\n                  {\r\n                    lang: 'sv',\r\n                    text: 'Medlemsnummer'\r\n                  },\r\n                  {\r\n                    lang: 'en',\r\n                    text: 'Member number'\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                deleted: 0,\r\n                lang_record_id: 'CLIENT_KUNDNUMMER',\r\n                page_name: 'all',\r\n                lang_text: [\r\n                  {\r\n                    lang: 'sv',\r\n                    text: 'Kundnummer'\r\n                  },\r\n                  {\r\n                    lang: 'en',\r\n                    text: 'Customer number'\r\n                  }\r\n                ]\r\n              }\r\n            ],\r\n            valtype: 'string',\r\n            special: false,\r\n            func: '',\r\n            max_length: 512,\r\n            variations: ['medlemsnummer', 'kundnummer'],\r\n            entity: 'company',\r\n            lang_record: {\r\n              deleted: 0,\r\n              lang_record_id: 'CLIENT_PUBLIC_ID',\r\n              page_name: 'all',\r\n              lang_text: [\r\n                {\r\n                  lang: 'sv',\r\n                  text: 'Medlemsnummer'\r\n                },\r\n                {\r\n                  lang: 'en',\r\n                  text: ''\r\n                }\r\n              ]\r\n            },\r\n            exclude: ['tfn', 'tel']\r\n          }\r\n        ]\r\n      },\r\n      requirements: {\r\n        personnr: false,\r\n        ssn: false,\r\n        phone: false,\r\n        email: false,\r\n        address: false,\r\n        fullname: false,\r\n        emailorphone: false,\r\n        sex: false,\r\n        age: false\r\n      },\r\n      periodName: '',\r\n      poll: false,\r\n      import_id: '',\r\n      startImport: false,\r\n      file_id: '',\r\n      doFinalize: false\r\n    };\r\n  },\r\n  watch: {\r\n    currentPage(newValue, oldValue) {\r\n      console.log('current page change: ' + newValue);\r\n\r\n      if (newValue === 4) {\r\n        this.startImport = true;\r\n        this.showNext = false;\r\n      }\r\n    },\r\n    currentCompanyId(newValue, oldvalue) {\r\n      if (newValue) {\r\n        this.loadData();\r\n      }\r\n    },\r\n    currentPeriodId(newValue, oldValue) {\r\n      if (newValue) {\r\n        this.loadData();\r\n        this.setPeriodName();\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    loadCountries() {\r\n      axios\r\n        .get('/location/countries')\r\n        .then(res => {\r\n          this.countries = res.data.countries;\r\n        })\r\n        .catch(err => {\r\n          console.error(err);\r\n          this.toastr('danger', 'Fel', 'Kunde inte hämta lista på länder');\r\n        });\r\n    },\r\n    handleFileUpload() {\r\n      this.file = this.$refs.file.files[0];\r\n\r\n      this.uploadFile();\r\n    },\r\n    selectFile() {\r\n      console.log('click')\r\n      this.$refs.file.click();\r\n    },\r\n    uploadFile() {\r\n      let formData = new FormData();\r\n      formData.append('file', this.file);\r\n\r\n      formData.append('file_source', 'files');\r\n      formData.append('file_type', 'IMPORT_MEMBERS');\r\n      formData.append('company_id', this.currentCompanyId);\r\n      formData.append('period_id', this.currentPeriodId);\r\n\r\n      axios\r\n        .post('/fileupload', formData, {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data'\r\n          }\r\n        })\r\n        .then(res => {\r\n          //this.toastr('success', 'OK', 'Filen laddades upp');\r\n\r\n          this.file_id = res.data.fileobjs[0].file_id;\r\n\r\n          this.readColumnDefFromFile(this.file_id);\r\n\r\n\r\n        })\r\n        .catch(err => {\r\n          console.error(err);\r\n          this.toastr('danger', 'Server Fel', 'Kunde inte ladda upp fil');\r\n        });\r\n    },\r\n    setPeriodName() {\r\n      for (var i = 0; i < this.periods.length; ++i) {\r\n        if (this.periods[i].id === this.currentPeriodId) {\r\n          this.periodName = this.periods[i].name;\r\n          return;\r\n        }\r\n      }\r\n    },\r\n    showCountryGuide() {\r\n      this.loadCountries();\r\n\r\n      this.displayCountryGuide = !this.displayCountryGuide;\r\n    },\r\n    nextPage(e) {\r\n      e.preventDefault();\r\n\r\n      this.wizard.goNext();\r\n\r\n      console.log('next page: ');\r\n      console.log(this.wizard.getStep());\r\n\r\n      if (this.wizard.getStep() === 3) {\r\n        this.showNext = false;\r\n        this.startImport = true;\r\n      }\r\n\r\n      // when we have clicked next to the final page, we need to tell the component to do the finalize import step\r\n      if (this.wizard.getStep() === 4) {\r\n        this.doFinalize = true;\r\n        this.lastPage = true;\r\n      }\r\n    },\r\n    submit() {},\r\n    async loadData() {\r\n      if (!this.currentCompanyId) {\r\n        return;\r\n      }\r\n      if (!this.currentPeriodId) {\r\n        return;\r\n      }\r\n\r\n      this.setDbColDefOptions();\r\n    },\r\n    readColumnDefFromFile(file_id) {\r\n      axios\r\n        .get(`/import/read_column_defs?type=companies&file_id=${file_id}`)\r\n        .then(res => {\r\n          if (res.status === 200) {\r\n            //this.requirements = res.data.requirements;\r\n            this.type_def = res.data.type_def;\r\n            this.column_def = res.data.column_def;\r\n\r\n            this.wizard.goNext();\r\n\r\n            this.setDbColDefOptions();\r\n            this.setMappingRedRows();\r\n          }\r\n          else if (res.status === 409) {\r\n            this.toastr('danger', 'Fel', res.data.message, 10000);\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.error(err);\r\n          this.toastr('danger', 'Server Fel', 'Kunde inte tolka filen');\r\n        });\r\n    },\r\n    setMappingRedRows() {\r\n      var dups = false;\r\n      // we set duplicate rows as red\r\n      for (var i = 0; i < this.column_def.mapped_columns.length; ++i) {\r\n        var mc1 = this.column_def.mapped_columns[i];\r\n        mc1.duplicate = false;\r\n      }\r\n\r\n      for (var i = 0; i < this.column_def.mapped_columns.length; ++i) {\r\n        var mc1 = this.column_def.mapped_columns[i];\r\n\r\n        if (mc1.db.col_name === 'skip') {\r\n          continue;\r\n        }\r\n\r\n        for (var j = 0; j < this.column_def.mapped_columns.length; ++j) {\r\n          if (i === j) {\r\n            continue;\r\n          }\r\n\r\n          var mc2 = this.column_def.mapped_columns[j];\r\n\r\n          if (mc1.db.col_name === mc2.db.col_name) {\r\n            mc1.duplicate = true;\r\n            dups = true;\r\n          }\r\n        }\r\n      }\r\n\r\n      this.showNext = !dups;\r\n\r\n      this.refreshMappingKeys();\r\n    },\r\n    getLangText(lang_text, lang) {\r\n      for (var i = 0; i < lang_text.length; ++i) {\r\n        if (lang_text[i].lang === lang) {\r\n          return lang_text[i].text;\r\n        }\r\n      }\r\n\r\n      return 'Språköversättning saknas';\r\n    },\r\n    setDbColDefOptions() {\r\n      this.dbColumnOptions = [];\r\n\r\n      for (var i = 0; i < this.type_def.columns.length; ++i) {\r\n        this.dbColumnOptions.push({\r\n          value: this.type_def.columns[i].col_name,\r\n          text: this.getLangText(this.type_def.columns[i].lang_record.lang_text, 'sv')\r\n        });\r\n      }\r\n    },\r\n    coldefSelected(coldef) {\r\n      this.setMappingRedRows();\r\n    },\r\n    refreshMappingKeys() {\r\n      for (var i = 0; i < this.column_def.mapped_columns.length; ++i) {\r\n        this.column_def.mapped_columns[i].id = this.randomstr(8);\r\n      }\r\n\r\n      for (var i = 0; i < this.$refs.importColDefRows.length; ++i) {\r\n        this.$refs.importColDefRows[i].updateComponent();\r\n      }\r\n    },\r\n    randomstr(length) {\r\n      let result = '';\r\n      const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n      const charactersLength = characters.length;\r\n\r\n      for (let i = 0; i < length; i++) {\r\n        result += characters.charAt(Math.floor(Math.random() * charactersLength));\r\n      }\r\n\r\n      return result;\r\n    },\r\n    setImportId(import_id) {\r\n      console.log('import id set: ' + this.import_id);\r\n      this.import_id = import_id;\r\n    },\r\n    finalizeReady(import_option) {\r\n      this.showNext = true;\r\n      this.import_option = import_option;\r\n    },\r\n    importFinalized() {\r\n      this.$refs.btnContinue.click();\r\n    },\r\n    importFailed() {\r\n      this.$refs.btnContinue.click();\r\n    },\r\n    toastr(type, title, message, autohide = 2000) {\r\n      this.$bvToast.toast(message, {\r\n        title: title,\r\n        autoHideDelay: autohide,\r\n        appendToast: true,\r\n        variant: type\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImportCompanies.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImportCompanies.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ImportCompanies.vue?vue&type=template&id=22593549&scoped=true&\"\nimport script from \"./ImportCompanies.vue?vue&type=script&lang=js&\"\nexport * from \"./ImportCompanies.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ImportCompanies.vue?vue&type=style&index=0&id=22593549&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"22593549\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}