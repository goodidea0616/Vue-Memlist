(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d18b0a7"],{"0be8":function(t,e,a){},"1da1":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("d3b7");function s(t,e,a,s,i,n,r){try{var o=t[n](r),c=o.value}catch(l){return void a(l)}o.done?e(c):Promise.resolve(c).then(s,i)}function i(t){return function(){var e=this,a=arguments;return new Promise((function(i,n){var r=t.apply(e,a);function o(t){s(r,i,n,o,c,"next",t)}function c(t){s(r,i,n,o,c,"throw",t)}o(void 0)}))}}},"29f8":function(t,e,a){},"2f71":function(t,e,a){"use strict";a("b86b")},"3b0f":function(t,e,a){"use strict";a("47a7")},4645:function(t,e,a){},"47a7":function(t,e,a){},"4dcb":function(t,e,a){"use strict";a("4645")},6570:function(t,e,a){"use strict";a("29f8")},"6f7f":function(t,e,a){},"825d":function(t,e,a){"use strict";a("897f")},"897f":function(t,e,a){},"96cf":function(t,e,a){var s=function(t){"use strict";var e,a=Object.prototype,s=a.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",r=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function c(t,e,a){return Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch($){c=function(t,e,a){return t[e]=a}}function l(t,e,a,s){var i=e&&e.prototype instanceof f?e:f,n=Object.create(i.prototype),r=new E(s||[]);return n._invoke=S(t,a,r),n}function d(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch($){return{type:"throw",arg:$}}}t.wrap=l;var p="suspendedStart",u="suspendedYield",m="executing",v="completed",h={};function f(){}function b(){}function k(){}var _={};_[n]=function(){return this};var g=Object.getPrototypeOf,y=g&&g(g(T([])));y&&y!==a&&s.call(y,n)&&(_=y);var C=k.prototype=f.prototype=Object.create(_);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function a(i,n,r,o){var c=d(t[i],t,n);if("throw"!==c.type){var l=c.arg,p=l.value;return p&&"object"===typeof p&&s.call(p,"__await")?e.resolve(p.__await).then((function(t){a("next",t,r,o)}),(function(t){a("throw",t,r,o)})):e.resolve(p).then((function(t){l.value=t,r(l)}),(function(t){return a("throw",t,r,o)}))}o(c.arg)}var i;function n(t,s){function n(){return new e((function(e,i){a(t,s,e,i)}))}return i=i?i.then(n,n):n()}this._invoke=n}function S(t,e,a){var s=p;return function(i,n){if(s===m)throw new Error("Generator is already running");if(s===v){if("throw"===i)throw n;return I()}a.method=i,a.arg=n;while(1){var r=a.delegate;if(r){var o=O(r,a);if(o){if(o===h)continue;return o}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===p)throw s=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=m;var c=d(t,e,a);if("normal"===c.type){if(s=a.done?v:u,c.arg===h)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(s=v,a.method="throw",a.arg=c.arg)}}}function O(t,a){var s=t.iterator[a.method];if(s===e){if(a.delegate=null,"throw"===a.method){if(t.iterator["return"]&&(a.method="return",a.arg=e,O(t,a),"throw"===a.method))return h;a.method="throw",a.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=d(s,t.iterator,a.arg);if("throw"===i.type)return a.method="throw",a.arg=i.arg,a.delegate=null,h;var n=i.arg;return n?n.done?(a[t.resultName]=n.value,a.next=t.nextLoc,"return"!==a.method&&(a.method="next",a.arg=e),a.delegate=null,h):n:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,h)}function z(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(z,this),this.reset(!0)}function T(t){if(t){var a=t[n];if(a)return a.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function a(){while(++i<t.length)if(s.call(t,i))return a.value=t[i],a.done=!1,a;return a.value=e,a.done=!0,a};return r.next=r}}return{next:I}}function I(){return{value:e,done:!0}}return b.prototype=C.constructor=k,k.constructor=b,b.displayName=c(k,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,k):(t.__proto__=k,c(t,o,"GeneratorFunction")),t.prototype=Object.create(C),t},t.awrap=function(t){return{__await:t}},w(x.prototype),x.prototype[r]=function(){return this},t.AsyncIterator=x,t.async=function(e,a,s,i,n){void 0===n&&(n=Promise);var r=new x(l(e,a,s,i),n);return t.isGeneratorFunction(a)?r:r.next().then((function(t){return t.done?t.value:r.next()}))},w(C),c(C,o,"Generator"),C[n]=function(){return this},C.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var a in t)e.push(a);return e.reverse(),function a(){while(e.length){var s=e.pop();if(s in t)return a.value=s,a.done=!1,a}return a.done=!0,a}},t.values=T,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var a in this)"t"===a.charAt(0)&&s.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var a=this;function i(s,i){return o.type="throw",o.arg=t,a.next=s,i&&(a.method="next",a.arg=e),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],o=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var c=s.call(r,"catchLoc"),l=s.call(r,"finallyLoc");if(c&&l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(t,e){for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a];if(i.tryLoc<=this.prev&&s.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var r=n?n.completion:{};return r.type=t,r.arg=e,n?(this.method="next",this.next=n.finallyLoc,h):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),j(a),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var s=a.completion;if("throw"===s.type){var i=s.arg;j(a)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,a,s){return this.delegate={iterator:T(t),resultName:a,nextLoc:s},"next"===this.method&&(this.arg=e),h}},t}(t.exports);try{regeneratorRuntime=s}catch(i){Function("r","regeneratorRuntime = r")(s)}},b4fc:function(t,e,a){},b86b:function(t,e,a){},bf87:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"px-5",attrs:{id:"page-stickprovs"}},[a("h5",{staticClass:"mb-6 ml-2"},[t._v("Stickprover")]),t.creating?a("StickprovWizard",{staticClass:"scroll-to-wizard",attrs:{stickprovs:t.stickprovs},on:{stickprovCreated:t.stickprovCreated}}):t._e(),a("StickprovTable",{attrs:{items:t.stickprovs},on:{showHistoryToggled:t.showHistoryToggled,createStickprovClicked:t.createStickprovClicked,selectStickprovClicked:t.selectStickprovClicked,deleteStickprovClicked:t.deleteStickprovClicked,startEvent:t.startEvent,toastr:t.toastr}}),a("div",{staticClass:"scroll-to-container"}),t.creating||t.editing?a("b-card",{ref:"edit-stickprov",staticClass:"mb-2 edit-stickprov-container",attrs:{title:"",id:"edit-stickprov","hide-footer":""}},[a("div",[a("b-form",{staticClass:"mt-8",on:{submit:t.saveStickprov}},[a("b-row",[a("b-col",{attrs:{lg:"12"}},[a("ClientTable",{staticClass:"search-results",attrs:{stickprov:t.stickprov,clients:t.clients},on:{clientSelected:t.clientSelected,confirm:t.confirm,reject:t.reject}})],1)],1)],1)],1)]):t._e()],1)},i=[],n=(a("99af"),a("4de4"),a("c740"),a("b0c0"),a("96cf"),a("1da1")),r=a("5530"),o=a("ca72"),c=a("bc3a"),l=a.n(c),d=a("c1df"),p=a.n(d),u=a("2f62"),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card card-custom card-stretch gutter-b"},[a("div",{staticClass:"card-header border-0 py-5"},[t._m(0),a("div",{staticClass:"card-toolbar"},[a("div",{staticClass:"d-flex align-items-center mr-12"},[a("label",{staticClass:"checkbox checkbox-lg checkbox-outline checkbox-success"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.show_history,expression:"show_history"}],attrs:{type:"checkbox",name:""},domProps:{checked:Array.isArray(t.show_history)?t._i(t.show_history,null)>-1:t.show_history},on:{click:function(e){t.show_history=!t.show_history},change:function(e){var a=t.show_history,s=e.target,i=!!s.checked;if(Array.isArray(a)){var n=null,r=t._i(a,n);s.checked?r<0&&(t.show_history=a.concat([n])):r>-1&&(t.show_history=a.slice(0,r).concat(a.slice(r+1)))}else t.show_history=i}}}),a("span")]),a("span",{staticClass:"ml-3 cursor-pointer"},[t._v("Visa Tidigare Stickprover")])]),a("a",{staticClass:"btn btn-primary font-weight-bolder font-size-sm",attrs:{href:"#"},on:{click:t.createStickprovClicked}},[a("i",{staticClass:"menu-icon flaticon2-plus",staticStyle:{"font-size":"1.0em"}}),t._v("Nytt Stickprov")])])]),a("div",{staticClass:"card-body pt-0"},[a("b-table",{staticClass:"w-100 mh-100",attrs:{id:"stickprov-table",fields:t.headers,items:t.items,"head-variant":"light","sticky-header":""},scopedSlots:t._u([{key:"cell(stickprov_id)",fn:function(e){return[a("div",{staticClass:"justify-content-end d-flex"},[a("a",{staticClass:"btn btn-icon btn-light btn-sm mx-3",attrs:{href:"#",hidden:!Boolean(e.item.is_stopped)},on:{click:function(a){return t.startEvent(e.item.stickprov_id,!0)}}},[a("span",{staticClass:"svg-icon svg-icon-md svg-icon-primary"},[a("i",{staticClass:"fas fa-play",staticStyle:{color:"#3699FF"}})])]),a("a",{staticClass:"btn btn-icon btn-light btn-sm mx-3",attrs:{href:"#",hidden:Boolean(e.item.is_stopped)},on:{click:function(a){return t.startEvent(e.item.stickprov_id,!1)}}},[a("span",{staticClass:"svg-icon svg-icon-md svg-icon-primary"},[a("i",{staticClass:"fas fa-stop",staticStyle:{color:"#e63113"}})])]),a("a",{staticClass:"btn btn-icon btn-light btn-sm mr-3",attrs:{href:"#"},on:{click:function(a){return t.selectStickprovClicked(e.item.stickprov_id)}}},[a("span",{staticClass:"svg-icon svg-icon-md svg-icon-primary"},[a("inline-svg",{attrs:{src:"/assets/svg/Write.svg"}})],1)]),a("a",{staticClass:"btn btn-icon btn-light btn-sm",attrs:{href:"#"},on:{click:function(a){return t.deleteStickprovClicked(e.item.stickprov_id)}}},[a("span",{staticClass:"svg-icon svg-icon-md svg-icon-primary"},[a("inline-svg",{attrs:{src:"/assets/svg/Trash.svg"}})],1)])])]}}])})],1),a("div",{staticClass:"card-body pt-0 pb-3"})])},v=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h3",{staticClass:"card-title align-items-start flex-column"},[a("span",{staticClass:"card-label font-weight-bolder text-dark"})])}],h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[a("span",{staticClass:"text-dark-75 font-weight-bolder d-block font-size-lg"},[t._v(t._s(t.stickprov.company_name))])]),a("td",[t._v(t._s(t.stickprov.deadline))]),a("td",[t._v(t._s(t.stickprov.num_clients))]),a("td",[t._v(t._s(t.stickprov.num_answers))]),a("td",[t._v(t._s(t.stickprov.num_confirm))]),a("td",[t._v(t._s(t.stickprov.num_reject))]),a("td",{staticClass:"text-right pr-0"},[t.stickprov.is_stopped?a("a",{staticClass:"btn btn-icon btn-light btn-sm mx-3",attrs:{href:"#"},on:{click:function(e){return t.startEvent(t.stickprov.stickprov_id)}}},[t._m(0)]):t._e(),t.stickprov.is_stopped?t._e():a("a",{staticClass:"btn btn-icon btn-light btn-sm mx-3",attrs:{href:"#"},on:{click:function(e){return t.stopEvent(t.stickprov.stickprov_id)}}},[t._m(1)]),a("a",{staticClass:"btn btn-icon btn-light btn-sm mx-3",attrs:{href:"#"},on:{click:function(e){return t.selectStickprovClicked(t.stickprov.stickprov_id)}}},[a("span",{staticClass:"svg-icon svg-icon-md svg-icon-primary"},[a("inline-svg",{attrs:{src:"/assets/svg/Write.svg"}})],1)]),a("a",{staticClass:"btn btn-icon btn-light btn-sm mx-3",attrs:{href:"#"},on:{click:function(e){return t.deleteStickprovClicked(t.stickprov.stickprov_id)}}},[a("span",{staticClass:"svg-icon svg-icon-md svg-icon-primary"},[a("inline-svg",{attrs:{src:"/assets/svg/Trash.svg"}})],1)])])])},f=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"svg-icon svg-icon-md svg-icon-primary"},[a("i",{staticClass:"fas fa-play",staticStyle:{color:"#3699FF"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"svg-icon svg-icon-md svg-icon-primary"},[a("i",{staticClass:"fas fa-stop",staticStyle:{color:"#e63113"}})])}],b={name:"stickprov-table-row",props:["stickprov"],computed:Object(r["a"])({},Object(u["b"])(["currentCompanyId"])),data:function(){return{}},mounted:function(){},watch:{},methods:{startEvent:function(t){this.$emit("startEvent",t,!0)},stopEvent:function(t){this.$emit("startEvent",t,!1)},selectStickprovClicked:function(t){this.$emit("selectStickprovClicked",t)},deleteStickprovClicked:function(t){this.$emit("deleteStickprovClicked",t)}}},k=b,_=(a("de13"),a("2877")),g=Object(_["a"])(k,h,f,!1,null,"68753d6c",null),y=g.exports,C={name:"stickprovs-table",props:["items","currentCompanyId"],components:{StickprovTableRow:y},watch:{show_history:function(t,e){this.$emit("showHistoryToggled",t)}},methods:{createStickprovClicked:function(){this.$emit("createStickprovClicked")},selectStickprovClicked:function(t){this.$emit("selectStickprovClicked",t)},deleteStickprovClicked:function(t){this.$emit("deleteStickprovClicked",t)},startEvent:function(t,e){this.$emit("startEvent",t,e)},toastr:function(t,e,a){this.$emit("toastr",t,e,a)}},data:function(){return{show_history:!1,headers:[{key:"company_name",label:"Förening",sortable:!0,thClass:"pl-7",tdClass:"pl-7"},{key:"deadline",label:"Deadline",thClass:"w-110px",tdClass:"w-110px",sortable:!0},{key:"num_clients",label:"Medlemmar",thClass:"w-120px",sortable:!0},{key:"num_answers",label:"Svar",thClass:"w-50px"},{key:"num_confirm",label:"Ja",thClass:"w-50px"},{key:"num_reject",label:"Nej",thClass:"w-45px"},{key:"stickprov_id",label:"",thClass:"w-140px pl-0",tdClass:"w-140px pl-0"}],list:[]}}},w=C,x=(a("dd0ae"),Object(_["a"])(w,m,v,!1,null,"226eeb4b",null)),S=x.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"px-5 mb-8",attrs:{id:"page-stickprovwizard"}},[a("b-modal",{ref:"previewModal",attrs:{"hide-footer":""}},[a("div",{domProps:{innerHTML:t._s(t.previewContent)}})]),a("h4",{staticClass:"mb-8 ml-2 mt-8"},[t._v("Skapa nytt stickprov")]),t.created?a("b-card",{staticClass:"mb-2 mt-2",attrs:{title:"Stickprovet skapat!","hide-footer":""}},[a("b-alert",{attrs:{variant:"success",show:""}},[t._v("Stickprovet har skapats")])],1):t._e(),t.created?t._e():a("b-card",{staticClass:"mb-2",attrs:{title:"","hide-footer":""}},[a("div",{staticClass:"wizard wizard-3",attrs:{id:"kt_wizard_v3","data-wizard-state":"step-first","data-wizard-clickable":"true"}},[a("div",{staticClass:"wizard-nav border-bottom mb-1 mb-lg-5"},[a("div",{staticClass:"wizard-steps px-8 py-8 px-lg-15 py-lg-3"},[a("div",{staticClass:"wizard-step",attrs:{"data-wizard-type":"step","data-wizard-state":"current"}},[a("div",{staticClass:"wizard-label"},[a("h3",{staticClass:"wizard-title"},[a("span",[t._v("1")]),t._v(" Introduktion ")]),a("div",{staticClass:"wizard-bar"})])]),a("div",{staticClass:"wizard-step",attrs:{"data-wizard-type":"step","data-wizard-state":"pending"}},[a("div",{staticClass:"wizard-label"},[a("h3",{staticClass:"wizard-title"},[a("span",[t._v("2")]),t._v(" Föreningsval ")]),a("div",{staticClass:"wizard-bar"})])]),a("div",{staticClass:"wizard-step",attrs:{"data-wizard-type":"step","data-wizard-state":"pending"}},[a("div",{staticClass:"wizard-label"},[a("h3",{staticClass:"wizard-title"},[a("span",[t._v("3")]),t._v(" Urvalsgrupp ")]),a("div",{staticClass:"wizard-bar"})])]),a("div",{staticClass:"wizard-step",attrs:{"data-wizard-type":"step","data-wizard-state":"pending"}},[a("div",{staticClass:"wizard-label"},[a("h3",{staticClass:"wizard-title"},[a("span",[t._v("4")]),t._v(" Alternativ ")]),a("div",{staticClass:"wizard-bar"})])]),a("div",{staticClass:"wizard-step",attrs:{"data-wizard-type":"step","data-wizard-state":"pending"}},[a("div",{staticClass:"wizard-label"},[a("h3",{staticClass:"wizard-title"},[a("span",[t._v("5")]),t._v(" Slutdatum ")]),a("div",{staticClass:"wizard-bar"})])]),a("div",{staticClass:"wizard-step",attrs:{"data-wizard-type":"step","data-wizard-state":"pending"}},[a("div",{staticClass:"wizard-label"},[a("h3",{staticClass:"wizard-title"},[a("span",[t._v("6")]),t._v(" Mallar ")]),a("div",{staticClass:"wizard-bar"})])]),a("div",{staticClass:"wizard-step",attrs:{"data-wizard-type":"step","data-wizard-state":"pending"}},[a("div",{staticClass:"wizard-label"},[a("h3",{staticClass:"wizard-title"},[a("span",[t._v("7")]),t._v(" Bekräfta ")]),a("div",{staticClass:"wizard-bar"})])])])]),a("div",{staticClass:"row justify-content-center py-12 px-8 py-lg-15 px-lg-10"},[a("div",{staticClass:"col-xl-12 col-xxl-7"},[a("form",{staticClass:"form",attrs:{id:"kt_form"}},[a("div",{staticClass:"pb-5",attrs:{"data-wizard-type":"step-content","data-wizard-state":"current"}},[a("b-alert",{attrs:{show:"",variant:"secondary"}},[t._v("Du kommer nu att skapa ett nytt stickprov. Följ guiden och fyll i allt som behövs. Stickprovet kommer inte vara igång förrän det har skapats OCH du har valt att starta stickprovet.")])],1),a("div",{staticClass:"pb-5",attrs:{"data-wizard-type":"step-content","data-wizard-state":"pending"}},[a("b-alert",{attrs:{show:"",variant:"secondary"}},[t._v("Välj vilja föreningar som ska ingå i stickprovet. Du kan även ange att varje förening ska få ett eget individuellt stickprov skapat åt sig.")]),a("div",{staticClass:"form-group"},[a("div",{staticClass:"radio-list"},[a("label",{staticClass:"radio radio-outline radio-success mb-4"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.createOption,expression:"createOption"}],attrs:{type:"radio",value:"split",name:"createOption"},domProps:{checked:t._q(t.createOption,"split")},on:{change:function(e){t.createOption="split"}}}),a("span"),t._v(" Alla markerade föreningar får egna stickprover ")]),a("label",{staticClass:"radio radio-outline radio-success mb-4"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.createOption,expression:"createOption"}],attrs:{type:"radio",value:"combine",name:"createOption"},domProps:{checked:t._q(t.createOption,"combine")},on:{change:function(e){t.createOption="combine"}}}),a("span"),t._v(" Skapa endast stickprovet på "+t._s(t.company.name)+" men med medlemmar från alla markerade föreningar ")])])]),a("CompanySelectTable",{attrs:{filterIds:t.filterCompanies,onlySubCompanies:!0},on:{onSelectionChanged:t.onCompanySelectionChanged}})],1),a("div",{staticClass:"pb-5",attrs:{"data-wizard-type":"step-content","data-wizard-state":"pending"}},[a("b-alert",{attrs:{show:"",variant:"secondary"}},[t._v("Ange hur stor andel (i procent) av medlemmar som ska ingå i stickprovet")]),a("div",{staticClass:"form-group"},[a("b-form-input",{attrs:{type:"range",min:"1",max:"100"},model:{value:t.pct_members,callback:function(e){t.pct_members=e},expression:"pct_members"}})],1),a("b-row",[a("b-col",{attrs:{lg:"4"}},[a("b-form-group",{attrs:{id:"input-group-2",label:"Procent av medlemmar","label-for":"input-2"}},[a("b-form-input",{staticClass:"mb-2",attrs:{type:"text",id:"input-2",disabled:""},model:{value:t.pct_members_text,callback:function(e){t.pct_members_text=e},expression:"pct_members_text"}})],1)],1),a("b-col",{attrs:{lg:"4"}},[a("b-form-group",{attrs:{id:"input-group-3",label:"Antal medlemmar","label-for":"input-3"}},[a("b-form-input",{staticClass:"mb-2",attrs:{type:"text",id:"input-3",disabled:""},model:{value:t.num_members_text,callback:function(e){t.num_members_text=e},expression:"num_members_text"}})],1)],1)],1)],1),a("div",{staticClass:"pb-5",attrs:{"data-wizard-type":"step-content","data-wizard-state":"pending"}},[a("b-alert",{attrs:{show:"",variant:"secondary"}},[t._v("Medlemmar som innefattas av stickprovet kommer att få en länk skickad till sig där man bekräftar sitt medlemskap. Ange hur du vill att systemet ska skicka ut dessa länkar"),a("br"),t._v("Ifall du väljer SMS och/eller E-post så kommer 3 påminnelser att skickas ut till varje medlem som inte svarar, därefter kan du göra manuell uppringning på kvarvarande medlemmar")]),a("div",{staticClass:"form-group"},[a("div",{staticClass:"check-list"},[a("div",{staticClass:"d-flex align-items-center mb-4"},[a("label",{staticClass:"checkbox checkbox-lg checkbox-outline checkbox-success"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.call_only,expression:"call_only"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.call_only)?t._i(t.call_only,null)>-1:t.call_only},on:{click:function(e){t.call_only=!t.call_only},change:function(e){var a=t.call_only,s=e.target,i=!!s.checked;if(Array.isArray(a)){var n=null,r=t._i(a,n);s.checked?r<0&&(t.call_only=a.concat([n])):r>-1&&(t.call_only=a.slice(0,r).concat(a.slice(r+1)))}else t.call_only=i}}}),a("span")]),a("span",{staticClass:"ml-3 cursor-pointer"},[t._v("Endast manuell uppringning")])]),a("div",{staticClass:"d-flex align-items-center mb-4"},[a("label",{staticClass:"checkbox checkbox-lg checkbox-outline checkbox-success"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.sendoutOptions,expression:"sendoutOptions"}],attrs:{type:"checkbox",value:"email",disabled:t.emailDisabled},domProps:{checked:Array.isArray(t.sendoutOptions)?t._i(t.sendoutOptions,"email")>-1:t.sendoutOptions},on:{change:function(e){var a=t.sendoutOptions,s=e.target,i=!!s.checked;if(Array.isArray(a)){var n="email",r=t._i(a,n);s.checked?r<0&&(t.sendoutOptions=a.concat([n])):r>-1&&(t.sendoutOptions=a.slice(0,r).concat(a.slice(r+1)))}else t.sendoutOptions=i}}}),a("span")]),a("span",{staticClass:"ml-3 cursor-pointer"},[t._v("E-post")])]),a("div",{staticClass:"d-flex align-items-center mb-4"},[a("label",{staticClass:"checkbox checkbox-lg checkbox-outline checkbox-success"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.sendoutOptions,expression:"sendoutOptions"}],attrs:{type:"checkbox",value:"sms",disabled:t.smsDisabled},domProps:{checked:Array.isArray(t.sendoutOptions)?t._i(t.sendoutOptions,"sms")>-1:t.sendoutOptions},on:{change:function(e){var a=t.sendoutOptions,s=e.target,i=!!s.checked;if(Array.isArray(a)){var n="sms",r=t._i(a,n);s.checked?r<0&&(t.sendoutOptions=a.concat([n])):r>-1&&(t.sendoutOptions=a.slice(0,r).concat(a.slice(r+1)))}else t.sendoutOptions=i}}}),a("span")]),a("span",{staticClass:"ml-3 cursor-pointer"},[t._v("SMS")])])])])],1),a("div",{staticClass:"pb-5",attrs:{"data-wizard-type":"step-content","data-wizard-state":"pending"}},[a("b-alert",{attrs:{show:"",variant:"secondary"}},[t._v("Ange sista datum för stickprovet. När detta datum inträffar så kommer inga utskick längre att ske.")]),a("b-form-group",{attrs:{id:"input-group-datepicker",label:"Slutdatum","label-for":"input-datepicker"}},[a("b-form-datepicker",{staticClass:"mb-2",attrs:{id:"input-datepicker"},model:{value:t.form.deadline,callback:function(e){t.$set(t.form,"deadline",e)},expression:"form.deadline"}})],1)],1),a("div",{staticClass:"pb-5",attrs:{"data-wizard-type":"step-content","data-wizard-state":"pending"}},[a("h5",[t._v("Mallar för utskick")]),t.sendEmail?a("div",[a("b-alert",{attrs:{show:"",variant:"secondary"}},[t._v("I stickprovet har det angetts att e-post skall skickas, välj vilken mall som ska skickas ut till medlemmarna.")]),a("b-row",[a("b-col",{attrs:{lg:"8"}},[a("b-form-group",{attrs:{id:"email_template_id-group",label:"E-postmall att skicka ut","label-for":"email_template_id"}},[a("b-form-select",{attrs:{id:"email_template_id",options:t.emailTemplatesOptions},model:{value:t.email_template_id,callback:function(e){t.email_template_id=e},expression:"email_template_id"}})],1)],1),a("b-col",{attrs:{lg:"4"}},[t.showPreviewEmail?a("b-button",{staticStyle:{"margin-top":"26px"},attrs:{type:"button",variant:"outline-secondary"},on:{click:function(e){return t.previewEmailClicked(e)}}},[t._v("Förhandsgranska")]):t._e()],1)],1)],1):t._e(),t.sendSMS?a("div",[a("b-alert",{attrs:{show:"",variant:"secondary"}},[t._v("I stickprovet har det angetts att SMS skall skickas, välj vilken mall som ska skickas ut till medlemmarna.")]),a("b-row",[a("b-col",{attrs:{lg:"8"}},[a("b-form-group",{attrs:{id:"sms_template_id-group",label:"SMS att skicka ut","label-for":"sms_template_id"}},[a("b-form-select",{attrs:{id:"sms_template_id",options:t.smsTemplatesOptions},model:{value:t.sms_template_id,callback:function(e){t.sms_template_id=e},expression:"sms_template_id"}})],1)],1),a("b-col",{attrs:{lg:"4"}},[t.showPreviewSms?a("b-button",{staticStyle:{"margin-top":"26px"},attrs:{type:"button",variant:"outline-secondary"},on:{click:function(e){return t.previewSmsClicked(e)}}},[t._v("Förhandsgranska")]):t._e()],1)],1)],1):t._e()]),a("div",{staticClass:"pb-5",attrs:{"data-wizard-type":"step-content","data-wizard-state":"pending"}},[a("b-alert",{attrs:{show:"",variant:"secondary"}},[t._v('Stickprovet kommer att skapas när du klickar på "Skapa stickprov". Notera att de automatiska utskicken ej kommer att starta förrän du har aktivt valt att "Starta" stickprovet.')])],1),a("div",{staticClass:"d-flex justify-content-between border-top pt-10"},[a("div",{staticClass:"mr-2"},[a("button",{staticClass:"btn btn-light-primary font-weight-bold text-uppercase px-9 py-4",attrs:{"data-wizard-type":"action-prev"}},[t._v(" Föregående ")])]),a("div",[a("button",{staticClass:"btn btn-primary font-weight-bold text-uppercase px-9 py-4 text-right",attrs:{"data-wizard-type":"action-next",disabled:t.disabledNextButton},on:{click:t.nextPage}},[t._v(" Nästa steg ")])]),a("div",[7===t.currentPage?a("button",{staticClass:"btn btn-primary font-weight-bold text-uppercase px-9 py-4",attrs:{"data-ktwizard-type":"action-submit"},on:{click:t.createStickprov}},[t._v(" Skapa stickprov ")]):t._e()])])])])])])])],1)},z=[],j=(a("b64b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card card-custom card-stretch gutter-b"},[t._m(0),a("div",{staticClass:"card-body pt-0 pb-3"},[a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-head-custom table-vertical-center table-head-bg table-borderless"},[a("thead",[a("tr",{staticClass:"text-left"},[a("th",{},[a("div",{staticClass:"d-flex align-items-center"},[a("label",{staticClass:"checkbox checkbox-lg checkbox-single"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.allSelected,expression:"allSelected"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.allSelected)?t._i(t.allSelected,null)>-1:t.allSelected},on:{click:function(e){t.allSelected=!t.allSelected},change:function(e){var a=t.allSelected,s=e.target,i=!!s.checked;if(Array.isArray(a)){var n=null,r=t._i(a,n);s.checked?r<0&&(t.allSelected=a.concat([n])):r>-1&&(t.allSelected=a.slice(0,r).concat(a.slice(r+1)))}else t.allSelected=i}}}),a("span")]),a("span",{staticClass:"ml-3 cursor-pointer"})])]),a("th",[t._v("Förening")]),a("th",[t._v("Medlemmar")])])]),t.onlySubCompanies?t._e():a("tbody",[t._l(t.companies,(function(e,s){return[a("CompanySelectTableRow",{key:s,attrs:{companyselect:e,currentCompanyId:t.currentCompanyId,available:t.isEnable(e),allSelected:t.allSelected},on:{companySelected:t.companySelected,toastr:t.toastr}})]}))],2),t.onlySubCompanies?a("tbody",[t._l(t.subCompanies,(function(e,s){return[a("CompanySelectTableRow",{key:s,attrs:{companyselect:e,currentCompanyId:t.currentCompanyId,available:t.isEnable(e),allSelected:t.allSelected},on:{companySelected:t.companySelected,toastr:t.toastr}})]}))],2):t._e()])])])])}),E=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card-header border-0 py-5"},[a("h3",{staticClass:"card-title align-items-start flex-column"},[a("span",{staticClass:"card-label font-weight-bolder text-dark"},[t._v("Föreningar att ingå i stickprov")])]),a("div",{staticClass:"card-toolbar"})])}],T=(a("7db0"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{attrs:{disabled:!t.available}},[a("div",{staticClass:"d-flex align-items-center"},[a("label",{staticClass:"checkbox checkbox-lg checkbox-outline checkbox-outline-2x checkbox-primary"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],attrs:{type:"checkbox",disabled:!t.available},domProps:{checked:Array.isArray(t.selected)?t._i(t.selected,null)>-1:t.selected},on:{click:function(e){t.selected=!t.selected},change:function(e){var a=t.selected,s=e.target,i=!!s.checked;if(Array.isArray(a)){var n=null,r=t._i(a,n);s.checked?r<0&&(t.selected=a.concat([n])):r>-1&&(t.selected=a.slice(0,r).concat(a.slice(r+1)))}else t.selected=i}}}),a("span")]),a("span",{staticClass:"ml-3 cursor-pointer"})])]),a("td",[t._v(t._s(t.companyselect.name))]),a("td",[t.available?t._e():a("label",{staticStyle:{color:"red"}},[t._v(" Det finns redan ett stickprov på föreningen ")])])])}),I=[],$={name:"companyselect-table-row",props:["companyselect","allSelected","available"],computed:Object(r["a"])({},Object(u["b"])(["currentCompanyId"])),data:function(){return{selected:!1}},mounted:function(){this.companyselect.id===this.currentCompanyId&&(this.selected=!0),this.selected=this.selected&&this.available},watch:{allSelected:function(t,e){this.selected=t},selected:function(t,e){this.$emit("companySelected",this.companyselect.id,t)},available:function(t,e){this.selected=this.selected&&this.available}},methods:{}},P=$,F=(a("6570"),Object(_["a"])(P,T,I,!1,null,"5b41cef9",null)),N=F.exports,A={name:"companyselects-table",components:{CompanySelectTableRow:N},props:{filterIds:{type:Array,default:[]},onlySubCompanies:{type:Boolean,default:!1}},computed:Object(r["a"])({},Object(u["b"])(["companies","currentCompanyId"])),mounted:function(){this.loadCompanies()},watch:{currentCompanyId:function(t,e){this.onlySubCompanies&&this.loadCompanies()},filterIds:function(t,e){}},methods:{companySelected:function(t,e){e?this.selectedCompanies.push(t):this.selectedCompanies=this.selectedCompanies.filter((function(e){return e!==t})),this.$emit("onSelectionChanged",this.selectedCompanies)},loadCompanies:function(){var t=this;l.a.get("/company/publiclist?company_id=".concat(this.currentCompanyId)).then((function(e){console.log(e),t.subCompanies=e.data.companies})).catch((function(t){console.log(t)}))},isEnable:function(t){return void 0==this.filterIds.find((function(e){return t.id==e.id}))},toastr:function(t,e,a){this.$emit("toastr",t,e,a)}},data:function(){return{allSelected:!1,show_history:!1,selectedCompanies:[],subCompanies:[]}}},L=A,D=(a("4dcb"),Object(_["a"])(L,j,E,!1,null,"6225c090",null)),K=D.exports,M=a("ae1f"),R=a("a7c1"),B={name:"stickprovwizard",components:{CompanySelectTable:K},props:["stickprovs"],computed:Object(r["a"])(Object(r["a"])({},Object(u["b"])(["currentCompanyId","currentPeriodId","companies","periods"])),{},{disabledNextButton:function(){if(!this.wizard)return!1;switch(this.wizard.currentStep){case 2:return!(Object.keys(this.counts).length>0)||(null===this.createOption||0===Object.keys(this.counts.counts).length);case 3:return 0===this.pct_members;case 4:return!this.call_only&&0===this.sendoutOptions.length;case 5:return!this.form.deadline;default:return!1}}}),mounted:function(){console.log(this.periods),this.loadData();for(var t=0;t<this.companies.length;++t)if(this.companies[t].id===this.currentCompanyId){this.company={id:this.currentCompanyId,name:this.companies[t].name};break}this.createWizard()},data:function(){return{smsDisabled:!1,emailDisabled:!1,call_only:!1,previewContent:"",sendEmail:!1,sendSMS:!1,sms_template_id:"",email_template_id:"",smsTemplatesOptions:[],emailTemplatesOptions:[],templates:[],created:!1,sendoutOptions:[],form:{},showNext:!0,currentPage:0,wizard:null,createOption:null,companySelection:[],company:{id:"",name:""},pct_members:0,pct_members_text:"0 %",num_members_text:0,num_members_total:3e4,showPreviewSms:!1,showPreviewEmail:!1,filterCompanies:[],counts:{}}},watch:{call_only:function(t,e){t?(this.sendoutOptions=[],this.emailDisabled=!0,this.smsDisabled=!0):(this.emailDisabled=!1,this.smsDisabled=!1)},sms_template_id:function(t,e){this.showPreviewSms=!(!t||""===t)},email_template_id:function(t,e){this.showPreviewEmail=!(!t||""===t)},pct_members:function(t,e){this.form.pct_members=t,this.pct_members_text=t+" %",this.num_members_text=Math.floor(this.num_members_total*(t/100))},sendoutOptions:function(t,e){this.sendEmail=!1,this.sendSMS=!1;for(var a=0;a<t.length;++a)"email"===t[a]?this.sendEmail=!0:"sms"===t[a]&&(this.sendSMS=!0)},showNext:function(t,e){console.log("showNext changed: "+t)}},methods:{loadTemplates:function(){var t=this;this.templates=[],this.smsTemplatesOptions=[],this.emailTemplatesOptions=[],l.a.get("/template/list?company_id=".concat(this.currentCompanyId)).then((function(e){200===e.status&&(t.templates=e.data.templates);for(var a=0;a<t.templates.length;++a)0===t.templates[a].is_sms?t.emailTemplatesOptions.push({value:t.templates[a].template_id,text:t.templates[a].name}):t.smsTemplatesOptions.push({value:t.templates[a].template_id,text:t.templates[a].name})})).catch((function(e){console.error(e),t.toastr("danger","Server Fel","Kunde inte lista mallar")}))},loadFilter:function(){var t=this,e=this.$loading.show();l.a.get("/stickprov/companies?period_id=".concat(this.currentPeriodId,"&company_id=").concat(this.currentCompanyId)).then((function(a){Array.isArray(a.data)?t.filterCompanies=a.data:t.filterCompanies=[],e.hide()})).catch((function(t){console.log(t),e.hide()}))},previewEmailClicked:function(t){t.preventDefault();var e=this;this.getTemplate(this.email_template_id,(function(t){e.previewContent=t.template,e.$refs["previewModal"].show()}))},previewSmsClicked:function(t){t.preventDefault();var e=this;this.getTemplate(this.sms_template_id,(function(t){e.previewContent=t.template,e.$refs["previewModal"].show()}))},getTemplate:function(t,e){var a=this;l.a.get("/template?template_id=".concat(t)).then((function(t){e(t.data.template)})).catch((function(t){console.error(t),a.toastr("danger","Server Fel","Kunde inte hämta malldata")}))},nextPage:function(){1===this.wizard.currentStep&&0===this.filterCompanies.length&&this.loadFilter()},onCompanySelectionChanged:function(t){var e=this;this.companySelection=t;var a=this.getCurrentPeriodDate();l.a.post("/client/count",{date:a,company_ids:this.companySelection}).then((function(t){e.counts=t.data,e.num_members_total=e.counts.total})).catch((function(t){console.error(t),e.toastr("danger","Server Fel","Kunde inte beräkna antal medlemmar")}))},getCurrentPeriodDate:function(){for(var t=0;t<this.periods.length;++t)if(this.periods[t].id===this.currentPeriodId)return this.periods[t].from;return""},createWizard:function(){var t=this;t.showNext=!0,t.wizard=new R["a"]("kt_wizard_v3",{startStep:1,clickableSteps:!0}),t.wizard.on("beforeNext",(function(){})),t.wizard.on("change",(function(){setTimeout((function(){M["a"].scrollTop(),t.currentPage=t.wizard.currentStep}),200)})),t.showNext=!1},countMembers:function(t){var e=this;l.a.post("/client/count",{company_ids:t}).then((function(t){e.num_members_total=t.data.total})).catch((function(t){console.error(t),e.toastr("danger","Server Fel","Kunde inte beräkna medlemmar")}))},createStickprov:function(t){var e=this;t.preventDefault();var a={company_id:this.currentCompanyId,period_id:this.currentPeriodId,company_ids:this.companySelection,company_option:this.createOption,deadline:this.form.deadline,email_template_id:this.email_template_id,sms_template_id:this.sms_template_id,send_email:this.sendEmail?1:0,send_sms:this.sendSMS?1:0,pct_clients:this.form.pct_members,company_name:this.company.name,call_only:this.call_only?1:0};l.a.post("/stickprov",a).then((function(t){if(e.toastr("success","OK","Stickprovet har skapats"),t.data.hasOwnProperty("stickprovs"))for(var a=0;a<t.data.stickprovs.length;++a)e.$emit("stickprovCreated",t.data.stickprovs[a]);else e.$emit("stickprovCreated",t.data.stickprov)})).catch((function(t){console.error(t),e.toastr("danger","Server Fel","Kunde inte skapa stickprov")}))},loadData:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.loadTemplates();case 2:case"end":return e.stop()}}),e)})))()},toastr:function(t,e,a){this.$bvToast.toast(a,{title:e,autoHideDelay:2e3,appendToast:!0,variant:t})}}},H=B,G=(a("3b0f"),Object(_["a"])(H,O,z,!1,null,"b6ae9148",null)),W=G.exports,J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card card-custom card-stretch gutter-b"},[a("div",{staticClass:"card-header border-0 py-5"},[t._m(0),a("div",{staticClass:"card-toolbar"},[a("a",{staticClass:"btn btn-primary font-weight-bolder font-size-sm mb-8",attrs:{href:"#"},on:{click:t.exportExcelClicked}},[a("i",{staticClass:"menu-icon flaticon2-plus",staticStyle:{"font-size":"1.0em"}}),t._v("Exportera Excel")])])]),a("div",{staticClass:"card-body pt-0"},[a("b-table",{staticClass:"w-100",attrs:{id:"stickprov-table",fields:t.headers,items:t.list,"head-variant":"light"},scopedSlots:t._u([{key:"cell(do_manual)",fn:function(e){return[1===e.item.do_manual&&0===e.item.done?a("b-button",{staticClass:"mr-2",attrs:{type:"button",variant:"primary"},on:{click:function(a){return t.confirm(e.item)}}},[t._v("Svara Ja")]):t._e(),1===e.item.do_manual&&0===e.item.done?a("b-button",{attrs:{type:"button",variant:"danger"},on:{click:function(a){return t.reject(e.item)}}},[t._v("Svara Nej")]):t._e(),0===e.item.do_manual?a("b-badge",{attrs:{variant:"light"}},[t._v("Nej")]):t._e()]}},{key:"cell(status)",fn:function(e){return[1===e.item.con?a("b-badge",{attrs:{variant:"success"}},[t._v("Bekräftat")]):t._e(),1===e.item.rej?a("b-badge",{attrs:{variant:"danger"}},[t._v("Ej medlem")]):t._e(),0===e.item.ans?a("b-badge",{attrs:{variant:"warning"}},[t._v("Ej svar")]):t._e()]}}])})],1)])},Y=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h3",{staticClass:"card-title align-items-start flex-column"},[a("span",{staticClass:"card-label font-weight-bolder text-dark"})])}],q=(a("d81d"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[a("span",{staticClass:"text-dark-75 font-weight-bolder d-block font-size-lg"},[t._v(t._s(t.client.firstname)+" "+t._s(t.client.lastname))])]),a("td",[t._v(" "+t._s(t.client.email)+" ")]),a("td",[t._v(" "+t._s(t.client.phone)+" ")]),a("td",[1===t.stickprov.call_only&&"no_answer"===t.status?a("b-button",{staticClass:"mr-2",attrs:{type:"button",variant:"primary"},on:{click:t.confirm}},[t._v("Svara Ja")]):t._e(),1===t.stickprov.call_only&&"no_answer"===t.status?a("b-button",{attrs:{type:"button",variant:"danger"},on:{click:t.reject}},[t._v("Svara Nej")]):t._e()],1),a("td",[a("h4",["confirmed"===t.status?a("b-badge",{attrs:{variant:"success"}},[t._v("Bekräftat")]):t._e(),"rejected"===t.status?a("b-badge",{attrs:{variant:"danger"}},[t._v("Ej medlem")]):t._e(),"no_answer"===t.status?a("b-badge",{attrs:{variant:"warning"}},[t._v("Ej svar")]):t._e()],1)])])}),V=[],U={name:"client-table-row",props:["client","stickprov"],computed:Object(r["a"])({},Object(u["b"])(["currentCompanyId"])),data:function(){return{status:""}},mounted:function(){this.refresh()},watch:{client:function(t,e){this.refresh()}},methods:{refresh:function(){console.log("refreshing"),1===this.client.st_conf?this.status="confirmed":1===this.client.st_rej?this.status="rejected":this.status="no_answer"},confirm:function(){this.$emit("confirm",this.client.client_id),this.status="confirmed"},reject:function(){this.$emit("reject",this.client.client_id),this.status="rejected"},selectClientClicked:function(t){this.$emit("selectClientClicked",t)},deleteClientClicked:function(t){this.$emit("deleteClientClicked",t)}}},Q=U,X=(a("f4f3"),Object(_["a"])(Q,q,V,!1,null,"7a4db3e7",null)),Z=X.exports,tt={name:"clients-table",props:["clients","currentCompanyId","stickprov"],components:{ClientTableRow:Z},watch:{clients:function(t,e){this.list=t.map((function(t){return{name:t.name,email:t.email,phone:t.phone,do_manual:t.do_manual,con:t.con,ans:t.ans,done:t.done,rej:t.rej,status:1===t.con?"confirmed":1===t.rej?"rejected":"no_answer",client_id:t.client_id}}))}},methods:{exportExcelClicked:function(){var t=this;l.a.post("/stickprov/xlsx",{stickprov_id:this.stickprov.stickprov_id}).then((function(t){location.href=t.data.file.public_path})).catch((function(e){console.error(e),t.toastr("danger","Fel","Kunde inte skapa Excelfil")}))},confirm:function(t){this.$emit("confirm",t.client_id),t.status="confirmed"},reject:function(t){this.$emit("reject",t.client_id),t.status="rejected"},selectClientClicked:function(t){this.$emit("selectClientClicked",t)},deleteClientClicked:function(t){this.$emit("deleteClientClicked",t)},toastr:function(t,e,a){this.$emit("toastr",t,e,a)}},data:function(){return{show_history:!1,headers:[{key:"name",label:"Namn",sortable:!0,thClass:"pl-7",tdClass:"pl-7"},{key:"email",label:"E-post",sortable:!0},{key:"phone",label:"Telefon",sortable:!0},{key:"do_manual",label:"Manuell"},{key:"status",label:"Status"}],list:[]}}},et=tt,at=(a("2f71"),Object(_["a"])(et,J,Y,!1,null,"582f8d48",null)),st=at.exports,it={name:"stickprovs",components:{StickprovTable:S,editor:o["a"],StickprovWizard:W,ClientTable:st},computed:Object(r["a"])({},Object(u["b"])(["currentCompanyId","currentPeriodId"])),mounted:function(){this.loadData()},data:function(){return{stickprov:null,clients:[],showHistory:!1,form:{stickprov_id:"",is_stopped:0,is_finished:0,num_sent_rounds:0,num_target_rounds:0,deadline:"2020-01-01",company_id:"",sms_template_id:"",email_template_id:"",call_only:0,num_answers:0,num_sms_sent:0,num_email_sent:0,pct_clients:0,num_clients:0,period_id:"",num_reject:0,send_email:0,send_sms:0,executing:0,next_execution:"2020-01-01"},online:!1,creating:!1,editing:!1,stickprovs:[],templates:[],emailTemplatesOptions:[],smsTemplatesOptions:[]}},watch:{currentCompanyId:function(t,e){t&&this.loadStickprovs()},stickprovs:function(t,e){}},methods:{confirm:function(t){var e=this;l.a.post("/client/stickprov",{client_id:t,answer:"confirm",stickprov_id:this.form.stickprov_id}).then((function(a){for(var s=0;s<e.clients.length;++s)e.clients[s].client_id===t&&(e.clients[s].st_conf=1)})).catch((function(t){console.error(t),e.toastr("danger","Server Fel","Kunde inte svara ja")}))},reject:function(t){var e=this;l.a.post("/client/stickprov",{client_id:t,answer:"reject",stickprov_id:this.form.stickprov_id}).then((function(a){for(var s=0;s<e.clients.length;++s)e.clients[s].client_id===t&&(e.clients[s].st_rej=1)})).catch((function(t){console.error(t),e.toastr("danger","Server Fel","Kunde inte svara nej")}))},loadClients:function(t){var e=this;l.a.get("/client_stickprov/list?stickprov_id=".concat(t)).then((function(t){e.clients=t.data.clients,console.log(e.clients)})).catch((function(t){console.error(t),e.toastr("danger","Server Fel","Kunde inte lista medlemmar")}))},clientSelected:function(t){console.log("selected client"),console.log(t)},showHistoryToggled:function(t){this.showHistory=t,this.loadStickprovs()},loadData:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.currentCompanyId){e.next=2;break}return e.abrupt("return");case 2:t.loadTemplates(),t.loadStickprovs();case 4:case"end":return e.stop()}}),e)})))()},createStickprovClicked:function(){this.createStickprov()},createStickprov:function(){this.creating=!0,this.editing=!0,this.scrollToWizard()},deleteStickprovClicked:function(t){var e=this;l.a.delete("/stickprov?stickprov_id=".concat(t,"&company_id=").concat(this.currentCompanyId)).then((function(a){e.stickprovs=e.stickprovs.filter((function(e){return e.stickprov_id!==t})),e.creating=!1,e.editing=!1,e.toastr("success","OK","Stickprovet togs bort")})).catch((function(t){console.error(t),e.toastr("danger","Server Fel","Kunde inte ta bort stickprov")}))},selectStickprovClicked:function(t){var e=this;l.a.get("/stickprov?stickprov_id=".concat(t,"&company_id=").concat(this.currentCompanyId)).then((function(t){e.form=t.data.stickprov,e.creating=!1,e.editing=!0,e.stickprov=e.form,e.loadClients(e.form.stickprov_id),e.scrollToEditStickprov()})).catch((function(t){console.error(t),e.toastr("danger","Server Fel","Kunde inte hämta stickprov")}))},startEvent:function(t,e){var a=this;e?l.a.put("/stickprov/start",{stickprov_id:t}).then((function(e){var s=a.stickprovs.findIndex((function(e){return e.stickprov_id==t}));s>-1&&(a.stickprovs[s].is_stopped=e.data.stickprov.is_stopped,a.toastr("success","OK","Stickprovet startades"))})).catch((function(t){console.error(t),a.toastr("danger","Server Fel","Kunde inte starta stickprov")})):l.a.put("/stickprov/stop",{stickprov_id:t}).then((function(e){var s=a.stickprovs.findIndex((function(e){return e.stickprov_id==t}));s>-1&&(a.stickprovs[s].is_stopped=e.data.stickprov.is_stopped,a.toastr("success","OK","Stickprovet stoppades"))})).catch((function(t){console.error(t),a.toastr("danger","Server Fel","Kunde inte stoppa stickprov")}))},getLangText:function(t,e){for(var a=0;a<t.length;++a)if(t[a].lang===e)return t[a].text;return"Språköversättning saknas"},loadStickprovs:function(){var t=this;this.stickprovs=[],l.a.get("/stickprov/list?company_id=".concat(this.currentCompanyId)).then((function(e){if(200===e.status)for(var a=e.data.stickprovlist,s=p()(),i=0;i<a.length;++i){var n=a[i],r=p()(n.deadline);(r<s&&t.showHistory||r>=s)&&t.stickprovs.push(n)}})).catch((function(e){console.error(e),t.toastr("danger","Server Fel","Kunde inte lista stickprov")}))},stickprovCreated:function(t){this.stickprovs.push(t),this.creating=!1,this.loadClients(t.stickprov_id),console.log("Got back signal from wizard")},loadTemplates:function(){var t=this;this.templates=[],this.smsTemplatesOptions=[],this.emailTemplatesOptions=[],l.a.get("/template/list?company_id=".concat(this.currentCompanyId)).then((function(e){200===e.status&&(t.templates=e.data.templates);for(var a=0;a<t.templates.length;++a)0===t.templates[a].is_sms?t.emailTemplatesOptions.push({value:t.templates[a].template_id,text:t.templates[a].name}):t.smsTemplatesOptions.push({value:t.templates[a].template_id,text:t.templates[a].name})})).catch((function(e){console.error(e),t.toastr("danger","Server Fel","Kunde inte lista mallar")}))},scrollToEditStickprov:function(){var t=this;setTimeout((function(){var e=t.$el.getElementsByClassName("scroll-to-container")[0];if(e){var a=-70,s=e.getBoundingClientRect().top+window.pageYOffset+a;window.scrollTo({top:s,behavior:"smooth"})}}),100)},scrollToWizard:function(){var t=this;setTimeout((function(){var e=t.$el.getElementsByClassName("scroll-to-wizard")[0];if(e){var a=-70,s=e.getBoundingClientRect().top+window.pageYOffset+a;window.scrollTo({top:s,behavior:"smooth"})}}),100)},saveStickprov:function(t){var e=this;void 0!==t&&t.prstickprovDefault(),this.form.company_id=this.currentCompanyId,this.form.type=this.online?"ONL":"PHY",l.a.put("/stickprov",this.form).then((function(t){200===t.status&&(e.toastr("success","OK","Stickprovet uppdaterades"),e.loadStickprovs())})).catch((function(t){console.error(t),e.toastr("danger","Server Fel","Kunde inte uppdatera stickprovet")}))},toastr:function(t,e,a){this.$bvToast.toast(a,{title:e,autoHideDelay:2e3,appendToast:!0,variant:t})}}},nt=it,rt=(a("825d"),Object(_["a"])(nt,s,i,!1,null,"98c85da6",null));e["default"]=rt.exports},dd0ae:function(t,e,a){"use strict";a("0be8")},de13:function(t,e,a){"use strict";a("6f7f")},f4f3:function(t,e,a){"use strict";a("b4fc")}}]);
//# sourceMappingURL=chunk-4d18b0a7.46d1bbca.js.map