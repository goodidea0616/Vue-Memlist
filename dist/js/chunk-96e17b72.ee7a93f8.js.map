{"version":3,"sources":["webpack:///./src/view/pages/ml/UserProfile.vue?a9a7","webpack:///./src/view/pages/ml/UserProfile.vue?7704","webpack:///src/view/pages/ml/UserProfile.vue","webpack:///./src/view/pages/ml/UserProfile.vue?cb79","webpack:///./src/view/pages/ml/UserProfile.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","user_id","companyTitles","on","saveUser","staticRenderFns","name","components","UserEdit","computed","data","watch","currentCompanyId","methods","setCompany","t","tt","id","form","console","log","res","status","value","err","toastr","$bvToast","toast","message","title","autoHideDelay","appendToast","variant","type","component","VTab","VTabItem","VTabs"],"mappings":"kHAAA,W,2CCAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,OAAOC,MAAM,CAAC,GAAK,uBAAuB,CAACH,EAAG,SAAS,CAACA,EAAG,SAAS,CAACG,MAAM,CAAC,mBAAmB,QAAQ,MAAQ,uBAAuB,MAAQ,KAAK,CAACH,EAAG,QAAQ,CAACJ,EAAIQ,GAAG,oBAAoBJ,EAAG,QAAQ,CAACJ,EAAIQ,GAAG,oBAAoBJ,EAAG,aAAa,CAACA,EAAG,WAAW,CAACG,MAAM,CAAC,QAAUP,EAAIS,QAAQ,cAAgBT,EAAIU,eAAeC,GAAG,CAAC,SAAWX,EAAIY,aAAa,GAAGR,EAAG,aAAa,CAACA,EAAG,oBAAoB,CAACE,YAAY,OAAOC,MAAM,CAAC,QAAUP,EAAIS,YAAY,IAAI,IAAI,IAAI,IAChkBI,EAAkB,G,iIC8CtB,GACEC,KAAM,eACNC,WAAY,CACVC,SAAJ,OAAI,kBAAJ,QAEEC,SAAU,OAAZ,OAAY,CAAZ,GACA,8FAEE,QARF,WAQA,wKACA,aADA,8CAGEC,KAXF,WAYI,MAAO,CACL,QAAN,KACM,OAAN,GACM,QAAN,GACM,KAAN,CACQ,QAAR,GACQ,MAAR,GACQ,UAAR,GACQ,SAAR,GACQ,eAAR,EACQ,aAAR,EACQ,SAAR,GACQ,WAAR,IACQ,IAAR,KAEM,aAAN,GACM,QAAN,CACA,CAAQ,MAAR,IAAQ,KAAR,OACA,CAAQ,MAAR,IAAQ,KAAR,UACA,CAAQ,MAAR,IAAQ,KAAR,SACA,CAAQ,MAAR,IAAQ,KAAR,UAEM,cAAN,GACM,UAAN,EACM,SAAN,EACM,UAAN,EACM,MAAN,GACM,OAAN,GACM,UAAN,GACM,cAAN,GACM,YAAN,IAGEC,MAAO,CACLC,iBADJ,SACA,QAMEC,QAAS,CACP,SADJ,WACA,wJAEA,4CACA,0BAEA,eALA,8CASIC,WAVJ,WAUA,WAEM,EAAN,EACA,IADA,8BACA,wBACA,kBAEQ,EAAR,EACA,sBACA,kBACU,IAAV,gBAEA,iCAEA,uBACY,EAAZ,IAGU,EAAV,UATU,IAAV,mBAWA,GAXU,IAWE,IAAZ,wBAAc,IAAd,6BACA,GADc,IACE,IAAK,EAArB,oCACkB,GAAIC,IAAMC,EAAGC,GAAI,CACf,EAApB,eACoB,QAJpB,gCAXA,SAAY,EAAZ,aAAY,EAAZ,IAoBU,QAAV,uBAGU,EAAV,iBAEU,IAAV,8BACY,EAAZ,oBAAc,KAAd,iBAAc,MAAd,iBAGU,QAAV,iBAEA,mBACU,QAAV,SACU,EAAV,6DAGA,mBACQ,QAAR,SACQ,EAAR,4DAGIb,SA3DJ,SA2DA,cAEMX,KAAKyB,KAAOA,EAEZ,EAAN,EACA,eACA,kBAEQ,OADAC,QAAQC,IAAIC,EAAK,OACTA,EAAIC,QACV,KAAV,IACU,KAAV,IAEY,IAFZ,mBAIA,iBAJY,IAIZ,0CACgB,GAAIP,EAAEQ,QAAU,EAAhC,eACA,EACA,QAPA,8BAWY,EAAZ,8CACY,MACF,KAAV,IACY,EAAZ,kFACY,UAGZ,mBACQJ,QAAQC,IAAII,EAAK,OACjB,EAAR,mEAIIC,OA7FJ,SA6FA,OACMhC,KAAKiC,SAASC,MAAMC,EAAS,CAC3BC,MAAOA,EACPC,cAAe,IACfC,aAAa,EACbC,QAASC,OCrMkW,I,iFCQ/WC,EAAY,eACd,EACA3C,EACAc,GACA,EACA,KACA,WACA,MAIa,aAAA6B,EAAiB,QAOhC,IAAkBA,EAAW,CAACC,OAAA,KAAKC,WAAA,KAASC,QAAA,Q","file":"js/chunk-96e17b72.ee7a93f8.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserProfile.vue?vue&type=style&index=0&id=56361a79&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"px-5\",attrs:{\"id\":\"page-profile-users\"}},[_c('b-card',[_c('v-tabs',{attrs:{\"background-color\":\"white\",\"color\":\"deep-purple accent-4\",\"right\":\"\"}},[_c('v-tab',[_vm._v(\"Mina uppgifter\")]),_c('v-tab',[_vm._v(\"Notifikationer\")]),_c('v-tab-item',[_c('UserEdit',{attrs:{\"user_id\":_vm.user_id,\"companyTitles\":_vm.companyTitles},on:{\"saveUser\":_vm.saveUser}})],1),_c('v-tab-item',[_c('UserNotifications',{staticClass:\"mt-8\",attrs:{\"user_id\":_vm.user_id}})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"px-5\" id=\"page-profile-users\">\r\n\r\n    <b-card>\r\n      <v-tabs\r\n        background-color=\"white\"\r\n        color=\"deep-purple accent-4\"\r\n        right\r\n      >\r\n        <v-tab>Mina uppgifter</v-tab>\r\n        <v-tab>Notifikationer</v-tab>\r\n\r\n        <v-tab-item>\r\n          <UserEdit \r\n            :user_id=\"user_id\"\r\n            :companyTitles=\"companyTitles\"\r\n            @saveUser=\"saveUser\"\r\n          />\r\n        </v-tab-item>\r\n         <v-tab-item>\r\n          <UserNotifications \r\n            class=\"mt-8\"\r\n            :user_id=\"user_id\"\r\n          />\r\n        </v-tab-item>\r\n      </v-tabs>\r\n    </b-card>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n.checkbox.checkbox-light-success > span {\r\n  background-color: white;\r\n  border: 1px solid #ddd;\r\n}\r\n\r\n</style>\r\n\r\n<script>\r\nimport validatePersonnr from '@/core/services/personnr';\r\nimport axios from 'axios';\r\nimport { mapGetters } from 'vuex';\r\nimport UserEdit from \"@/view/pages/ml/users/UserEdit.vue\";\r\nimport UserNotifications from '@/view/pages/ml/users/UserNotifications.vue';\r\n\r\n\r\nexport default {\r\n  name: 'user-profile',\r\n  components: {\r\n    UserEdit, UserNotifications\r\n  },\r\n  computed: {\r\n    ...mapGetters(['currentCompanyId', 'currentPeriodId', 'currentUserId', 'periods', 'companies']),\r\n  },\r\n  async mounted() {\r\n    await this.loadData();\r\n  },\r\n  data() {\r\n    return {\r\n        user_id: null,\r\n        titles: [],\r\n        company: {},\r\n        form: {\r\n            user_id: '',\r\n            email: '',\r\n            firstname: '',\r\n            lastname: '',\r\n            is_accountant: false,\r\n            is_director: false,\r\n            title_id: '',\r\n            public_sex: 'U',\r\n            sex: 'U'\r\n        },\r\n        invite_email: '',\r\n        genders: [\r\n            { value: 'M', text: 'Man' },\r\n            { value: 'F', text: 'Kvinna' },\r\n            { value: 'O', text: 'Annat' },\r\n            { value: 'U', text: 'Okänt' }\r\n        ],\r\n        companyTitles: [],\r\n        creating: false,\r\n        editing: false,\r\n        inviting: false,\r\n        users: [],\r\n        access: [],\r\n        tmpAccess: [],\r\n        checkedAccess: [],\r\n        checkedAll:false\r\n    };\r\n  },\r\n  watch: {\r\n    currentCompanyId(newValue, oldvalue) {\r\n      if (newValue) {\r\n      \r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    async loadData() {\r\n        \r\n        console.log('selectUser: ' + this.currentUserId);\r\n        this.user_id = this.currentUserId;\r\n\r\n        this.setCompany();\r\n        //this.selectUser(this.user_id)\r\n      \r\n    },\r\n    setCompany() {\r\n\r\n      axios\r\n        .get(`/company?company_id=${this.currentCompanyId}`)\r\n        .then(res => {\r\n\r\n          axios\r\n            .get('/system/titles')\r\n            .then(sres => {\r\n              let stitles = sres.data.titles;\r\n\r\n              let titles = res.data.company.settings.titles;\r\n\r\n              if (titles === null || titles === undefined) {\r\n                titles = [];\r\n              }\r\n\r\n              this.titles = [];\r\n\r\n              for (const t of titles) {\r\n                for (const tt of stitles) {\r\n                  if (t === tt.id) {\r\n                    this.titles.push(tt);\r\n                    break;\r\n                  }\r\n                }\r\n              }\r\n\r\n              console.log('titles loaded: ');\r\n              \r\n\r\n              this.companyTitles = [];\r\n\r\n              for (var i = 0; i < this.titles.length; ++i) {\r\n                this.companyTitles.push({ text: this.titles[i].name, value: this.titles[i].id });\r\n              }\r\n\r\n              console.log(this.titles)\r\n            })\r\n            .catch(err => {\r\n              console.error(err);\r\n              this.toastr('danger', 'Fel', 'Kunde inte hämta systemtitlar');\r\n            });\r\n        })\r\n        .catch(err => {\r\n          console.error(err);\r\n          this.toastr('danger', 'Fel', 'Kunde inte hämta inställningar');\r\n        });\r\n    },\r\n    saveUser(form) {\r\n      \r\n      this.form = form;\r\n\r\n      axios\r\n        .put('/user', form)\r\n        .then(res => {\r\n        console.log(res, \"res\");\r\n        switch (res.status) {\r\n            case 200:\r\n            case 204:\r\n\r\n            let title = { value: '', text: '' };\r\n\r\n            for (const t of this.companyTitles) {\r\n                if (t.value === this.form.title_id) {\r\n                title = t;\r\n                break;\r\n                }\r\n            }\r\n\r\n            this.toastr('success', 'OK', 'Användare uppdaterad');\r\n            break\r\n            case 409:\r\n            this.toastr('danger', 'Ogiltig e-postadress', 'Den angivna e-postadressen finns redan.');\r\n            break\r\n        }\r\n        })\r\n        .catch(err => {\r\n        console.log(err, \"err\");\r\n        this.toastr('danger', 'Server Fel', 'Kunde inte uppdatera användare');\r\n        });\r\n    \r\n    },\r\n    toastr(type, title, message) {\r\n      this.$bvToast.toast(message, {\r\n        title: title,\r\n        autoHideDelay: 2000,\r\n        appendToast: true,\r\n        variant: type,\r\n      })\r\n    }\r\n  }\r\n};\r\n</script>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserProfile.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserProfile.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserProfile.vue?vue&type=template&id=56361a79&scoped=true&\"\nimport script from \"./UserProfile.vue?vue&type=script&lang=js&\"\nexport * from \"./UserProfile.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserProfile.vue?vue&type=style&index=0&id=56361a79&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"56361a79\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VTab } from 'vuetify/lib/components/VTabs';\nimport { VTabItem } from 'vuetify/lib/components/VTabs';\nimport { VTabs } from 'vuetify/lib/components/VTabs';\ninstallComponents(component, {VTab,VTabItem,VTabs})\n"],"sourceRoot":""}